<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE beans PUBLIC "-//SPRING//DTD BEAN//EN"
      "http://www.springframework.org/dtd/spring-beans.dtd">
<beans>
    <!-- DAO real para IOL -->
    <bean id="ioldao" 
          class="ar.com.leak.iolsucker.impl.http.HTTPIolDao" 
          destroy-method="dispose"
          singleton="true">
          <constructor-arg ref="options"/>
          <constructor-arg>
				<bean class="ar.com.leak.iolsucker.impl.http.HTTPClient">
					<constructor-arg>
						<bean class="ar.com.leak.iolsucker.impl.http.NamingMapper">
							<constructor-arg index="0">
								<bean id="iolurl" class="org.springframework.beans.factory.config.MethodInvokingFactoryBean">
									<property name="targetObject" ref="options"/>
									<property name="targetMethod">
										<value>getURLBase</value>
									</property>
								</bean>
							</constructor-arg>
						</bean>
					</constructor-arg>
				</bean>
          </constructor-arg>
          <constructor-arg>
          	<bean class="ar.com.leak.iolsucker.impl.http.HTTPMaterialFactory">
          	    <constructor-arg index="0">
          	    	<value>10</value> <!-- cantidad de trabajadores en paralelo -->
          	    </constructor-arg>
          	    <constructor-arg index="1">
          	       <bean class="ar.com.leak.iolsucker.impl.http.DefaultRequestFactory">
	          	       <constructor-arg index="0" ref="relativePathValidator"/>
	          	       <constructor-arg index="1">
		          	       	<bean class="ar.com.leak.iolsucker.container.spring.StaticConditionalFactoryBean">
							   <property name="condition">
									<bean class="org.springframework.beans.factory.config.MethodInvokingFactoryBean">
										<property name="targetObject" ref="options"/>
										<property name="targetMethod">
											<value>isOldFashion</value>
										</property>
									</bean>
							   </property>
							   <property name="trueBean">
						 	      <bean class="ar.com.leak.iolsucker.impl.http.extras.OldFashionMaterialFileFactory"/>
							   </property>
							   <property name="falseBean">
						     	  <bean class="ar.com.leak.iolsucker.impl.http.DefaultRequestFactory$DefaultMaterialFileFactory"/>
							   </property>
							</bean>
	          	       </constructor-arg>
          	       </bean>
          	    </constructor-arg>
          	</bean>
          </constructor-arg>
    </bean>
</beans>